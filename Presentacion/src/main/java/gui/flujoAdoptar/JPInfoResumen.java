/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package gui.flujoAdoptar;

/**
 * Panel que muestra un resumen de toda la información de la solicitud de
 * adopción.
 * Permite al usuario revisar sus datos personales, información de vivienda,
 * antecedentes y la cita seleccionada antes de enviar la solicitud final.
 * 
 * @author angel
 */
public class JPInfoResumen extends javax.swing.JPanel {

        /** Controlador de presentación para la gestión de la lógica. */
        private control.ControlPresentacion controlPresentacion;

        /**
         * Crea una nueva instancia del panel JPInfoResumen.
         * Inicializa los componentes gráficos.
         */
        public JPInfoResumen() {
                initComponents();
        }

        /**
         * Establece el controlador de presentación.
         * 
         * @param controlPresentacion El controlador a asociar con este panel.
         */
        public void setControlPresentacion(control.ControlPresentacion controlPresentacion) {
                this.controlPresentacion = controlPresentacion;
        }

        /**
         * This method is called from within the constructor to initialize the form.
         * WARNING: Do NOT modify this code. The content of this method is always
         * regenerated by the Form Editor.
         */
        @SuppressWarnings("unchecked")
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // <editor-fold defaultstate="collapsed" desc="Generated
        // Code">//GEN-BEGIN:initComponents
        private void initComponents() {

                jPanel1 = new javax.swing.JPanel();
                jPanel2 = new javax.swing.JPanel();
                jPanel3 = new javax.swing.JPanel();
                lblImagenMascota = new javax.swing.JLabel();
                lblNombreMascota = new javax.swing.JLabel();
                lblDetallesMascota = new javax.swing.JLabel();
                jLabel4 = new javax.swing.JLabel();
                lblNombreSolicitante = new javax.swing.JLabel();
                lblCURP = new javax.swing.JLabel();
                jLabel6 = new javax.swing.JLabel();
                jLabel5 = new javax.swing.JLabel();
                jLabel8 = new javax.swing.JLabel();
                lblCitaPref = new javax.swing.JLabel();
                lblContacto = new javax.swing.JLabel();
                jLabel7 = new javax.swing.JLabel();
                jLabel9 = new javax.swing.JLabel();
                jLabel10 = new javax.swing.JLabel();
                lblTipoVivienda = new javax.swing.JLabel();
                lblConvivencia = new javax.swing.JLabel();
                jLabel11 = new javax.swing.JLabel();
                jCheckBox1 = new javax.swing.JCheckBox();
                btnAnterior = new javax.swing.JButton();
                btnEnviarSolicitud = new javax.swing.JButton();
                jLabel3 = new javax.swing.JLabel();
                Mascotas = new javax.swing.JLabel();
                lblMascotasSioNo = new javax.swing.JLabel();
                Mascotas1 = new javax.swing.JLabel();
                lblninosSioNo = new javax.swing.JLabel();
                jLabel2 = new javax.swing.JLabel();

                setBackground(new java.awt.Color(219, 213, 195));

                jPanel1.setBackground(new java.awt.Color(219, 213, 195));

                jPanel2.setBackground(new java.awt.Color(255, 255, 255));

                jPanel3.setBackground(new java.awt.Color(204, 255, 204));

                lblImagenMascota.setText("IMAGEN MASCOTA");

                lblNombreMascota.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
                lblNombreMascota.setText("NOMBRE MASCOTA");

                lblDetallesMascota.setFont(new java.awt.Font("Segoe UI", 0, 14)); // NOI18N
                lblDetallesMascota.setText("DETALLES MASCOTA");

                javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
                jPanel3.setLayout(jPanel3Layout);
                jPanel3Layout.setHorizontalGroup(
                                jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel3Layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addComponent(lblImagenMascota,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                87,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                .addGroup(jPanel3Layout
                                                                                .createParallelGroup(
                                                                                                javax.swing.GroupLayout.Alignment.LEADING,
                                                                                                false)
                                                                                .addComponent(lblNombreMascota,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE)
                                                                                .addComponent(lblDetallesMascota,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE))
                                                                .addContainerGap(164, Short.MAX_VALUE)));
                jPanel3Layout.setVerticalGroup(
                                jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel3Layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addGroup(jPanel3Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addGroup(jPanel3Layout
                                                                                                .createSequentialGroup()
                                                                                                .addComponent(lblNombreMascota)
                                                                                                .addPreferredGap(
                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                                                .addComponent(lblDetallesMascota)
                                                                                                .addGap(0, 34, Short.MAX_VALUE))
                                                                                .addComponent(lblImagenMascota,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                Short.MAX_VALUE))
                                                                .addContainerGap()));

                jLabel4.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
                jLabel4.setText("Datos del Solicitante");

                lblNombreSolicitante.setText("NOMBRE DEL SOLICITANTE");

                lblCURP.setText("CURP ");

                jLabel6.setText("CURP:");

                jLabel5.setText("Nombre:");

                jLabel8.setText("Cita Preferida:");

                lblCitaPref.setText("CITA PREFERIDA");

                lblContacto.setText("CONTACTO");

                jLabel7.setText("Contacto:");

                jLabel9.setFont(new java.awt.Font("Segoe UI", 0, 18)); // NOI18N
                jLabel9.setText("Condiciones del Hogar");

                jLabel10.setText("Tipo Vivienda:");

                lblTipoVivienda.setText("TIPO DE VIVIENDA");

                lblConvivencia.setText("DESC CONVIVENCIA");

                jLabel11.setText("Convivencia:");

                jCheckBox1.setText(
                                "Confirmo que toda la información es verídica y acepto la carte de compromiso de adopción");

                btnAnterior.setText("Anterior");
                btnAnterior.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnAnteriorActionPerformed(evt);
                        }
                });

                btnEnviarSolicitud.setBackground(new java.awt.Color(0, 102, 0));
                btnEnviarSolicitud.setText("Enviar Solicitud");
                btnEnviarSolicitud.addActionListener(new java.awt.event.ActionListener() {
                        public void actionPerformed(java.awt.event.ActionEvent evt) {
                                btnEnviarSolicitudActionPerformed(evt);
                        }
                });

                jLabel3.setFont(new java.awt.Font("Segoe UI", 0, 24)); // NOI18N
                jLabel3.setText("Paso 4: Resumen y Confirmacion");

                Mascotas.setText("Mascotas:");

                lblMascotasSioNo.setText("DESC CONVIVENCIA");

                Mascotas1.setText("Tiene niños:");

                lblninosSioNo.setText("DESC CONVIVENCIA");

                javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
                jPanel2.setLayout(jPanel2Layout);
                jPanel2Layout.setHorizontalGroup(
                                jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel2Layout.createSequentialGroup()
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addGroup(jPanel2Layout
                                                                                                .createSequentialGroup()
                                                                                                .addGap(54, 54, 54)
                                                                                                .addGroup(jPanel2Layout
                                                                                                                .createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel5)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(lblNombreSolicitante))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel7)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                                                                                .addComponent(lblContacto))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel8)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(lblCitaPref))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel6)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(lblCURP))))
                                                                                .addGroup(jPanel2Layout
                                                                                                .createSequentialGroup()
                                                                                                .addGap(50, 50, 50)
                                                                                                .addGroup(jPanel2Layout
                                                                                                                .createParallelGroup(
                                                                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel10)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(lblTipoVivienda))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(jLabel11)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(lblConvivencia))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(Mascotas)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(lblMascotasSioNo))
                                                                                                                .addGroup(jPanel2Layout
                                                                                                                                .createSequentialGroup()
                                                                                                                                .addComponent(Mascotas1)
                                                                                                                                .addPreferredGap(
                                                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                                                                                .addComponent(lblninosSioNo)))))
                                                                .addGap(478, 478, 478))
                                                .addGroup(jPanel2Layout.createSequentialGroup()
                                                                .addGap(29, 29, 29)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addComponent(jLabel3)
                                                                                .addComponent(jPanel3,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                                .addComponent(jLabel4)
                                                                                .addComponent(jLabel9)
                                                                                .addComponent(jCheckBox1)
                                                                                .addGroup(jPanel2Layout
                                                                                                .createSequentialGroup()
                                                                                                .addComponent(btnAnterior)
                                                                                                .addPreferredGap(
                                                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED,
                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                Short.MAX_VALUE)
                                                                                                .addComponent(btnEnviarSolicitud)))
                                                                .addGap(63, 63, 63)));
                jPanel2Layout.setVerticalGroup(
                                jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel2Layout.createSequentialGroup()
                                                                .addGap(22, 22, 22)
                                                                .addComponent(jLabel3)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(jPanel3,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                .addComponent(jLabel4)
                                                                .addGap(18, 18, 18)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel5)
                                                                                .addComponent(lblNombreSolicitante))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel6)
                                                                                .addComponent(lblCURP))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel8)
                                                                                .addComponent(lblCitaPref))
                                                                .addGap(4, 4, 4)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel7)
                                                                                .addComponent(lblContacto))
                                                                .addGap(18, 18, 18)
                                                                .addComponent(jLabel9)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel10)
                                                                                .addComponent(lblTipoVivienda))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(jLabel11)
                                                                                .addComponent(lblConvivencia))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(Mascotas)
                                                                                .addComponent(lblMascotasSioNo))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(Mascotas1)
                                                                                .addComponent(lblninosSioNo))
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                                .addComponent(jCheckBox1)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.UNRELATED,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                Short.MAX_VALUE)
                                                                .addGroup(jPanel2Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.BASELINE)
                                                                                .addComponent(btnAnterior)
                                                                                .addComponent(btnEnviarSolicitud))
                                                                .addGap(27, 27, 27)));

                jLabel2.setFont(new java.awt.Font("Segoe UI", 0, 36)); // NOI18N
                jLabel2.setText("Solicitud de Adopciones");

                javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
                jPanel1.setLayout(jPanel1Layout);
                jPanel1Layout.setHorizontalGroup(
                                jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(jPanel1Layout.createSequentialGroup()
                                                                .addGroup(jPanel1Layout.createParallelGroup(
                                                                                javax.swing.GroupLayout.Alignment.LEADING)
                                                                                .addGroup(jPanel1Layout
                                                                                                .createSequentialGroup()
                                                                                                .addGap(243, 243, 243)
                                                                                                .addComponent(jPanel2,
                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                                                javax.swing.GroupLayout.PREFERRED_SIZE))
                                                                                .addGroup(jPanel1Layout
                                                                                                .createSequentialGroup()
                                                                                                .addGap(119, 119, 119)
                                                                                                .addComponent(jLabel2)))
                                                                .addContainerGap(275, Short.MAX_VALUE)));
                jPanel1Layout.setVerticalGroup(
                                jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel1Layout
                                                                .createSequentialGroup()
                                                                .addContainerGap(18, Short.MAX_VALUE)
                                                                .addComponent(jLabel2)
                                                                .addPreferredGap(
                                                                                javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                                                .addComponent(jPanel2,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addContainerGap()));

                javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
                this.setLayout(layout);
                layout.setHorizontalGroup(
                                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(layout.createSequentialGroup()
                                                                .addContainerGap()
                                                                .addComponent(jPanel1,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addGap(0, 0, 0)));
                layout.setVerticalGroup(
                                layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addGroup(layout.createSequentialGroup()
                                                                .addGap(0, 0, 0)
                                                                .addComponent(jPanel1,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE,
                                                                                javax.swing.GroupLayout.DEFAULT_SIZE,
                                                                                javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                .addGap(0, 0, 0)));
        }// </editor-fold>//GEN-END:initComponents

        /**
         * Maneja el evento de regresar a la pantalla anterior.
         * 
         * @param evt El evento de acción.
         */
        private void btnAnteriorActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnAnteriorActionPerformed
                if (controlPresentacion != null) {
                        controlPresentacion.regresarDesdeInfoResumen();
                }
        }// GEN-LAST:event_btnAnteriorActionPerformed

        /**
         * Valida y envía la solicitud de adopción.
         * Verifica que se haya confirmado la veracidad de la información y que exista
         * una cita seleccionada.
         * 
         * @param evt El evento de acción.
         */
        private void btnEnviarSolicitudActionPerformed(java.awt.event.ActionEvent evt) {// GEN-FIRST:event_btnEnviarSolicitudActionPerformed
                if (controlPresentacion != null) {
                        if (!jCheckBox1.isSelected()) {
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "Debe confirmar que la información es verídica y aceptar la carta de compromiso.",
                                                "Confirmación requerida",
                                                javax.swing.JOptionPane.WARNING_MESSAGE);
                                return;
                        }

                        DTOS.CitaDTO cita = controlPresentacion.getCitaSeleccionada();
                        if (cita == null) {
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "No se ha seleccionado una cita. Por favor regrese y seleccione una.",
                                                "Error",
                                                javax.swing.JOptionPane.ERROR_MESSAGE);
                                return;
                        }

                        btnEnviarSolicitud.setEnabled(false);
                        try {
                                controlPresentacion.procesarCita(cita);
                                // No llamamos a finalizarProceso() aquí porque procesarCita()
                                // ya maneja la navegación (éxito -> confirmación, error -> error)
                        } catch (Exception e) {
                                btnEnviarSolicitud.setEnabled(true);
                                javax.swing.JOptionPane.showMessageDialog(this,
                                                "Error al enviar la solicitud: " + e.getMessage(),
                                                "Error",
                                                javax.swing.JOptionPane.ERROR_MESSAGE);
                        }
                }
        }// GEN-LAST:event_btnEnviarSolicitudActionPerformed

        /**
         * Carga y muestra los datos recopilados en los pasos anteriores.
         * Incluye información del usuario, la mascota seleccionada, vivienda,
         * antecedentes y la cita.
         * También gestiona la carga de la imagen de la mascota.
         */
        public void cargarDatos() {
                // Asegurar que el botón esté habilitado al cargar el panel
                btnEnviarSolicitud.setEnabled(true);

                if (controlPresentacion != null) {
                        DTOS.UsuarioDTO usuario = controlPresentacion.getUsuarioActual();
                        DTOS.SolicitudAdopcionDTO solicitud = controlPresentacion.getSolicitudActual();
                        DTOS.CitaDTO cita = controlPresentacion.getCitaSeleccionada();

                        // Cargar datos de la mascota seleccionada
                        String idMascota = controlPresentacion.getIdMascotaSeleccionada();
                        if (idMascota != null) {
                                DTOS.MascotaDTO mascota = controlPresentacion.getControlSubsistemas()
                                                .obtenerMascotaPorId(idMascota);
                                if (mascota != null) {
                                        lblNombreMascota.setText(
                                                        mascota.getNombre() != null ? mascota.getNombre() : "N/A");

                                        // Formatear detalles de la mascota
                                        String detalles = String.format("Especie: %s | Edad: %d años",
                                                        mascota.getEspecie() != null ? mascota.getEspecie() : "N/A",
                                                        mascota.getEdad());
                                        lblDetallesMascota.setText(detalles);

                                        // Cargar imagen de la mascota
                                        if (mascota.getUrlImagen() != null && !mascota.getUrlImagen().isEmpty()) {
                                                try {
                                                        System.out.println("Intentando cargar imagen: "
                                                                        + mascota.getUrlImagen());

                                                        javax.swing.ImageIcon icon = null;

                                                        // Detectar si es una URL externa o un recurso local
                                                        if (mascota.getUrlImagen().startsWith("http://") || mascota
                                                                        .getUrlImagen().startsWith("https://")) {
                                                                // Cargar desde URL externa
                                                                java.net.URL imageUrl = new java.net.URL(
                                                                                mascota.getUrlImagen());
                                                                icon = new javax.swing.ImageIcon(imageUrl);
                                                        } else {
                                                                // Cargar desde recursos locales
                                                                java.net.URL resourceUrl = getClass()
                                                                                .getResource(mascota.getUrlImagen());
                                                                if (resourceUrl != null) {
                                                                        icon = new javax.swing.ImageIcon(resourceUrl);
                                                                } else {
                                                                        System.err.println("Recurso no encontrado: "
                                                                                        + mascota.getUrlImagen());
                                                                        lblImagenMascota.setText("NO ENCONTRADO");
                                                                        lblImagenMascota.setIcon(null);
                                                                        return;
                                                                }
                                                        }

                                                        // Verificar que la imagen se cargó correctamente
                                                        if (icon != null && icon
                                                                        .getImageLoadStatus() == java.awt.MediaTracker.COMPLETE) {
                                                                // Redimensionar imagen
                                                                java.awt.Image image = icon.getImage()
                                                                                .getScaledInstance(87, 87,
                                                                                                java.awt.Image.SCALE_SMOOTH);
                                                                lblImagenMascota.setIcon(
                                                                                new javax.swing.ImageIcon(image));
                                                                lblImagenMascota.setText("");
                                                                System.out.println("Imagen cargada exitosamente");
                                                        } else {
                                                                System.err.println(
                                                                                "Error: La imagen no se cargó completamente");
                                                                lblImagenMascota.setText("ERROR IMG");
                                                                lblImagenMascota.setIcon(null);
                                                        }
                                                } catch (Exception e) {
                                                        System.err.println("Error al cargar imagen: " + e.getMessage());
                                                        e.printStackTrace();
                                                        lblImagenMascota.setText("ERROR");
                                                        lblImagenMascota.setIcon(null);
                                                }
                                        } else {
                                                System.out.println("URL de imagen vacía o null");
                                                lblImagenMascota.setText("SIN IMAGEN");
                                                lblImagenMascota.setIcon(null);
                                        }
                                }
                        }

                        if (usuario != null && usuario.getInfoPersonal() != null) {
                                lblNombreSolicitante.setText(usuario.getInfoPersonal().getNombre());
                                lblCURP.setText(usuario.getInfoPersonal().getCurp());
                                lblContacto.setText(usuario.getInfoPersonal().getCorreo());
                        }

                        if (usuario != null && usuario.getInfoVivienda() != null) {
                                System.out.println("DEBUG: Cargando info vivienda en resumen");
                                System.out.println(
                                                "DEBUG: Tipo vivienda: " + usuario.getInfoVivienda().getTipoVivienda());

                                lblTipoVivienda.setText(usuario.getInfoVivienda().getTipoVivienda());

                                // Mostrar si tiene mascotas
                                lblMascotasSioNo.setText(
                                                usuario.getInfoVivienda().isTieneOtrasMascotas() ? "Sí" : "No");

                                // Mostrar si tiene niños
                                lblninosSioNo.setText(usuario.getInfoVivienda().isTieneNinos() ? "Sí" : "No");
                        } else {
                                System.err.println("DEBUG: No se encontró info de vivienda");
                                if (usuario == null) {
                                        System.err.println("DEBUG: usuario es null");
                                } else if (usuario.getInfoVivienda() == null) {
                                        System.err.println("DEBUG: usuario.getInfoVivienda() es null");
                                }
                        }

                        if (solicitud != null && solicitud.getRazones() != null) {
                                lblConvivencia.setText(solicitud.getRazones().getAntecedentesMascotas());
                        }

                        if (cita != null && cita.getFechaHora() != null) {
                                // Formatear la fecha y hora de forma legible
                                java.time.format.DateTimeFormatter formatter = java.time.format.DateTimeFormatter
                                                .ofPattern("dd/MM/yyyy HH:mm");
                                String fechaFormateada = cita.getFechaHora().format(formatter);
                                lblCitaPref.setText(fechaFormateada);
                        }
                }
        }

        // Variables declaration - do not modify//GEN-BEGIN:variables
        private javax.swing.JLabel Mascotas;
        private javax.swing.JLabel Mascotas1;
        /** Botón para regresar al paso anterior */
        private javax.swing.JButton btnAnterior;
        /** Botón para enviar la solicitud final */
        private javax.swing.JButton btnEnviarSolicitud;
        /** Checkbox de confirmación de veracidad */
        private javax.swing.JCheckBox jCheckBox1;
        private javax.swing.JLabel jLabel10;
        private javax.swing.JLabel jLabel11;
        private javax.swing.JLabel jLabel2;
        private javax.swing.JLabel jLabel3;
        private javax.swing.JLabel jLabel4;
        private javax.swing.JLabel jLabel5;
        private javax.swing.JLabel jLabel6;
        private javax.swing.JLabel jLabel7;
        private javax.swing.JLabel jLabel8;
        private javax.swing.JLabel jLabel9;
        private javax.swing.JPanel jPanel1;
        private javax.swing.JPanel jPanel2;
        private javax.swing.JPanel jPanel3;
        /** Etiqueta para mostrar la CURP */
        private javax.swing.JLabel lblCURP;
        /** Etiqueta para mostrar la cita preferida */
        private javax.swing.JLabel lblCitaPref;
        /** Etiqueta para mostrar el contacto */
        private javax.swing.JLabel lblContacto;
        /** Etiqueta para mostrar antecedentes de convivencia */
        private javax.swing.JLabel lblConvivencia;
        /** Etiqueta para detalles de la mascota */
        private javax.swing.JLabel lblDetallesMascota;
        /** Etiqueta para la imagen de la mascota */
        private javax.swing.JLabel lblImagenMascota;
        /** Etiqueta para indicar si tiene otras mascotas */
        private javax.swing.JLabel lblMascotasSioNo;
        /** Etiqueta para el nombre de la mascota */
        private javax.swing.JLabel lblNombreMascota;
        /** Etiqueta para el nombre del solicitante */
        private javax.swing.JLabel lblNombreSolicitante;
        /** Etiqueta para el tipo de vivienda */
        private javax.swing.JLabel lblTipoVivienda;
        /** Etiqueta para indicar si tiene niños */
        private javax.swing.JLabel lblninosSioNo;
        // End of variables declaration//GEN-END:variables
}
